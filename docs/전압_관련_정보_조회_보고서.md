# 전압 관련 정보 조회 보고서

WFS(Web Feature Service)를 데이터 소스로 하여 전주·전선·변압기/인입선 레이어에서 전압 관련 필드를 조회한 결과입니다.

---

## 1. 데이터 소스

| 항목 | 값 |
|------|-----|
| WFS URL | `http://192.168.0.71:8881/orange/wfs?GDX=AI_FAC.xml` |
| 전주 레이어 | `AI_FAC_001.GIS_LOC` |
| 전선 레이어 | `AI_FAC_002.GIS_PTH` |
| 변압기/인입선 레이어 | `AI_FAC_003.GIS_PTH` |

---

## 2. 전주 레이어 — 전압/형태 관련 필드

### 2.1 실제 조회 결과 (BBox 기준 2000건 샘플)

| 필드명 | 설명 | 분포 (상위) |
|--------|------|-------------|
| **POLE_FORM_CD** | 전주 형태 코드 | O: 1915건, G: 76건, V: 9건 |
| **POLE_KND_CD** | 전주 종류 코드 | C: 1676건, H: 290건, B: 15건, Z: 9건, M: 4건 |
| LINE_NO | 선로 번호 등 (일부만 전압값 220 포함) | 220: 1건 |

### 2.2 코드에서의 사용

- **preprocessor**: `POLE_FORM_CD == "G"` 이면 지지주로 제외.  
  `POLE_KND_CD`는 보조로 사용, 실제 고압/저압은 **연결된 전선**으로 판단.
- **API (routes)**: `pole_type = props.get("POLE_FORM_CD", "H")`,  
  `is_high_voltage = (POLE_FORM_CD != "L")` 로 해석.

### 2.3 정리

- 전주 레이어에는 **VOLT_VAL(전압값)** 필드가 없음.
- **POLE_FORM_CD**: O(일반), G(지지주), V 등 → 앱에서는 H/L 구분에 활용.
- **POLE_KND_CD**: C, H, B, Z, M 등 → 전주 종류/용도 구분.

---

## 3. 전선 레이어 — 전압/종류/상 관련 필드

### 3.1 실제 조회 결과 (2000건 샘플)

| 필드명 | 설명 | 분포 (상위) |
|--------|------|-------------|
| **VOLT_VAL** | 전압값(V) | **(값 없음)** — 이 데이터에서는 비어 있음 |
| **PRWR_KND_CD** | 전선 종류(고압/저압 구분) | EC: 1118건, EW: 813건, TW: 61건, ZZ: 8건 |
| **PHAR_CLCD** | 상 구분 | ABC: 984건, CBA: 744건, BCA: 65건, CAB: 55건, A: 35건, C: 27건, B: 23건 등 |
| PRWR_SPEC_CD | 전선 규격 | 160: 802건, 58: 771건, 95: 345건 |
| NEWI_KND_CD | 인입선 종류 등 | AL: 1985건, WO: 7건, EW: 2건 |

### 3.2 코드에서의 사용 (preprocessor)

- **고압**: `PRWR_KND_CD` in `["HV","H","고압","EC","AL-OC","ACSR"]` 또는 `"EW"`(가공지선) → `line_type = "HV"`.
- **저압**: 그 밖의 값 → `line_type = "LV"`.
- **VOLT_VAL**이 숫자로 있으면:  
  - `>= 1000` → 고압,  
  - `0 < v < 1000` → 저압  
  로 최종 보정.
- **PHAR_CLCD**: CBA/ABC/RST 등 3글자면 3상("3"), A/B/C/S 등 단일 문자면 단상("1").

### 3.3 정리

- 현재 WFS 전선 데이터에서는 **VOLT_VAL**이 비어 있고, **PRWR_KND_CD**로 고압(EC, EW 등)/저압(TW, ZZ 등)을 구분하고 있음.
- **PHAR_CLCD**로 3상(ABC, CBA 등) / 단상(A, B, C 등) 구분.

---

## 4. 변압기/인입선 레이어 — 전압 관련 필드

### 4.1 실제 조회 결과 (2000건 샘플)

| 필드명 | 설명 | 분포 (상위) |
|--------|------|-------------|
| **LVW_KND_CD** | 저압선 종류 | OW: 1401건, AO: 238건, OC: 186건, C4: 101건, C2: 60건 |
| LVW_KND_CD2 | 저압선 종류 2 | ZZ: 1967건, OW: 17건, AO: 16건 |
| NEWI_KND_CD | 인입선 종류 | AL: 944건, OW: 457건, WO: 424건, ZZ: 163건, OC: 11건 |
| PHAR_CLCD | 상 구분 | ZZZ: 825건, A: 2건 |

### 4.2 정리

- 변압기/인입선 레이어에는 **VOLT_VAL** 필드가 보이지 않음.
- **LVW_KND_CD**, **NEWI_KND_CD** 등으로 저압/인입선 종류 구분.
- 인입선(O.W 등)은 전처리에서 저압선으로 추출해 경로 설계에 사용.

---

## 5. 애플리케이션 기준 전압 관련 필드 요약

| 레이어 | 전압 관련 주요 필드 | 비고 |
|--------|---------------------|------|
| 전주 | POLE_FORM_CD, POLE_KND_CD | VOLT_VAL 없음. 고압/저압은 연계 전선으로 판단 |
| 전선 | **VOLT_VAL**, **PRWR_KND_CD**, **PHAR_CLCD** | VOLT_VAL은 현재 데이터에서 비어 있음, PRWR_KND_CD로 구분 |
| 변압기/인입선 | LVW_KND_CD, NEWI_KND_CD, PHAR_CLCD | 저압·인입선 구분용 |

---

## 6. 재조회 방법

다음 명령으로 최신 전압 관련 통계를 다시 조회할 수 있습니다.

```bash
cd /root/elbix_aidd && python -m tests.voltage_report
```

`tests/voltage_report.py` 내부의 `bbox` 또는 `max_feat`를 바꾸면 조회 범위·건수를 조정할 수 있습니다.
